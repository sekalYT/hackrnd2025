# ü§ñ SourceCraft CLI: –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ö–æ–º–∞–Ω–¥–Ω–æ–π –°—Ç—Ä–æ–∫–∏

–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –¥–ª—è **SourceCraft**, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–∞—à–∏–º–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏, –ø—É–ª-—Ä–µ–∫–≤–µ—Å—Ç–∞–º–∏, –∑–∞–¥–∞—á–∞–º–∏ –∏ CI/CD –ø—Ä—è–º–æ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.

---

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏.

| –î–µ–π—Å—Ç–≤–∏–µ | –ö–æ–º–∞–Ω–¥–∞ |
| :--- | :--- |
| **–°–ø–∏—Å–æ–∫** –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø—É–ª-—Ä–µ–∫–≤–µ—Å—Ç–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ | `src pr list --state open` |
| **–°–æ–∑–¥–∞–Ω–∏–µ** –Ω–æ–≤–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è "My Project" | `src repo create --name "My Project" --description "–ú–æ–π –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç" --private` |
| **–ü—Ä–æ—Å–º–æ—Ç—Ä** –¥–µ—Ç–∞–ª–µ–π PR #10 –≤ `your-org/your-repo` | `src pr view 10 --repo your-org/your-repo` |
| **–°–ª–∏—è–Ω–∏–µ** PR #12 (squash –∏ —É–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ç–∫–∏) | `src pr merge 12 --squash --delete-branch` |
| **–°–æ–∑–¥–∞–Ω–∏–µ** –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ | `src issue create` |
| **–ó–∞–∫—Ä—ã—Ç–∏–µ** –∑–∞–¥–∞—á–∏ #3 | `src issue close 3` |
| **–ó–∞–ø—É—Å–∫** CI workflow 'main' –Ω–∞ –≤–µ—Ç–∫–µ 'develop' | `src workflow run main --ref develop` |
| **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–ø–æ ID) —Å —Ä–æ–ª—å—é 'developer' | `src access role add <User ID> --role developer` |
| **–£—Å—Ç–∞–Ω–æ–≤–∫–∞** pre-commit —Ö—É–∫–∞ | `src pre-commit install` |

---

## ‚ùì –ß–∞—Å—Ç–æ –ó–∞–¥–∞–≤–∞–µ–º—ã–µ –í–æ–ø—Ä–æ—Å—ã (FAQ)

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏ –¢–æ–∫–µ–Ω–æ–º (PAT)

**–í:** –Ø –ø–æ–ª—É—á–∞—é –æ—à–∏–±–∫—É `–û—à–∏–±–∫–∞: —Ç–æ–∫–µ–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω...` –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∫–æ–º–∞–Ω–¥.
**–û:** –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ CLI –Ω–µ —Å–º–æ–≥ –Ω–∞–π—Ç–∏ –≤–∞—à **–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –¢–æ–∫–µ–Ω –î–æ—Å—Ç—É–ø–∞ (PAT) SourceCraft**. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã:
1.  –í—ã–ø–æ–ª–Ω–∏–ª–∏ `src auth login` –∏ –≤—Å—Ç–∞–≤–∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π PAT.
2.  **–ò–ª–∏** —É—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `SOURCECRAFT_TOKEN`.
3.  –ü—Ä–æ–≤–µ—Ä–∏–ª–∏, —á—Ç–æ –≤–∞—à —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–æ–±—ã—á–Ω–æ `~/.config/src/config.yaml` –∏–ª–∏ –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ) —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç—Ä–æ–∫—É `token:`, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `auth login`.

### –û—à–∏–±–∫–∏ API –∏ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –û—Ç–≤–µ—Ç

**–í:** –ö–æ–º–∞–Ω–¥—ã `repo list` –∏–ª–∏ `repo create` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTML (`<!DOCTYPE html>...`) –∏–ª–∏ –æ—à–∏–±–∫—É `non-JSON response`.
**–û:** –û–±—ã—á–Ω–æ —ç—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –∏–ª–∏ –∞–¥—Ä–µ—Å–æ–º API:
1.  **–ù–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω:** –í–∞—à PAT –º–æ–≥ –∏—Å—Ç–µ—á—å –∏–ª–∏ –±—ã—Ç—å –æ—Ç–æ–∑–≤–∞–Ω. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `src auth logout`, –∞ –∑–∞—Ç–µ–º `src auth login` —Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º.
2.  **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL API:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É `api_base_url`. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `src config get api_base_url`. –ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å **`https://sourcecraft.dev/api/v1`**. –ï—Å–ª–∏ –æ–Ω–æ –¥—Ä—É–≥–æ–µ, –∏—Å–ø—Ä–∞–≤—å—Ç–µ —Å –ø–æ–º–æ—â—å—é `src config set api_base_url https://sourcecraft.dev/api/v1`.

**–í:** –Ø –ø–æ–ª—É—á–∞—é –æ—à–∏–±–∫—É **404 Not Found**, —á–∞—Å—Ç–æ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º `Cannot POST /api/v1/...` –∏–ª–∏ `workflow '' not found`.
**–û:** –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞—à–µ–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π API —ç–Ω–¥–ø–æ–∏–Ω—Ç.
* **–î–ª—è `repo create`:** –ú–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–º `POST /orgs/.../repos` –∏–ª–∏ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –º–æ–∂–µ—Ç–µ –ª–∏ –≤—ã —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
* **–î–ª—è `workflow run`:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–º—è workflow (–Ω–∞–ø—Ä–∏–º–µ—Ä, `main`) **—Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç** —Å –∏–º–µ–Ω–µ–º —Ñ–∞–π–ª–∞ (–±–µ–∑ `.yml`) –≤ –ø–∞–ø–∫–µ `.sourcecraft/ci/` –≤–∞—à–µ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –∏ —á—Ç–æ —ç—Ç–æ—Ç —Ñ–∞–π–ª –±—ã–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä (`git push`). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è (`main`, –±–µ–∑ `.yml`).
* **–û–±—â–µ–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `api_base_url` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (`https://sourcecraft.dev/api/v1`).

### –û—à–∏–±–∫–∏ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏ Git

**–í:** –ö–æ–º–∞–Ω–¥—ã `repo sync` –∏–ª–∏ `pr create` —Å–æ–æ–±—â–∞—é—Ç, —á—Ç–æ **–Ω–µ —É–¥–∞–ª–æ—Å—å –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**.
**–û:** –≠—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –ø—ã—Ç–∞—é—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ –≤–∞—à–µ–º—É Git remote —Å –∏–º–µ–Ω–µ–º `origin`. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
1.  –í—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –∫–æ–º–∞–Ω–¥—É **–≤–Ω—É—Ç—Ä–∏ –≤–∞—à–µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª–æ–Ω–∞** Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è.
2.  –£ –≤–∞—Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω `remote` —Å –∏–º–µ–Ω–µ–º `origin`, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ –≤–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π SourceCraft (–Ω–∞–ø—Ä–∏–º–µ—Ä, `git@sourcecraft.dev:your-org/your-repo.git`). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å –ø–æ–º–æ—â—å—é `git remote -v`.
3.  **–õ–∏–±–æ** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ `--repo <org>/<repo>`, —á—Ç–æ–±—ã —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –¥–ª—è –∫–æ–º–∞–Ω–¥—ã.

### –ü—Ä–æ—á–∏–µ –í–æ–ø—Ä–æ—Å—ã

**–í:** –ì–¥–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –º–æ–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏?
**–û:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é CLI –∏—â–µ—Ç `config.yaml` –≤ **—Ç–µ–∫—É—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏** (`.`), –∞ –∑–∞—Ç–µ–º –≤ **`~/.config/src/`**.

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

CLI –ø–æ—Å—Ç—Ä–æ–µ–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Go** –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ **Cobra**.

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- | :--- |
| **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥** | `/cmd` | –°–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É –¥–ª—è –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥. |
| **–ë–∞–∑–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞** | `root.go` | –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∞–∑–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É `src`, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç API-–∫–ª–∏–µ–Ω—Ç. |
| **–ö–æ–º–∞–Ω–¥—ã-–¥–µ–π—Å—Ç–≤–∏—è** | `*.go` –≤ `/cmd` | –†–µ–∞–ª–∏–∑—É—é—Ç –ª–æ–≥–∏–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `RunE`. |
| **API –ö–ª–∏–µ–Ω—Ç** | `internal/api/client.go` | –õ–æ–≥–∏–∫–∞ API-–∑–∞–ø—Ä–æ—Å–æ–≤ (`makeRequest`), —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –º–µ—Ç–æ–¥—ã –≤—ã–∑–æ–≤–æ–≤ API. |
| **–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ Git —Ñ—É–Ω–∫—Ü–∏–∏** | `internal/git/git.go` | –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ `git`. |

---

## üõ†Ô∏è –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

–ß—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `src newthing doaction`):

1.  **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É-–¥–µ–π—Å—Ç–≤–∏–µ**: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `cmd/newthing_doaction.go`, –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ `newthingDoactionCmd` –∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É –≤ –ø–æ–ª–µ **`RunE`**.
2.  **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å API**: –î–æ–±–∞–≤—å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –º–µ—Ç–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `DoAction(...)`) –∫ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ `api.Client` –≤ `internal/api/client.go` –∏ –≤—ã–∑–æ–≤–∏—Ç–µ –µ–≥–æ –∏–∑ `RunE`.
3.  **–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Git**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `internal/git/git.go`, –µ—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º.

---

## üì¶ –°–±–æ—Ä–∫–∞ –∏ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –°–±–æ—Ä–∫–∞
1.  **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Go**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è 1.18+.
2.  **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**:
    ```bash
    git clone <–∞–¥—Ä–µ—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>
    cd <–∏–º—è –ø–∞–ø–∫–∏>
    ```
3.  **–°–æ–±–µ—Ä–∏—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–π —Ñ–∞–π–ª**:
    ```bash
    go build -o src .
    ```
4.  **(–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–∏**:
    ```bash
    go build -o src -ldflags "-X main.version=v1.2.3" .
    ```

### –ö—Ä–æ—Å—Å-–∫–æ–º–ø–∏–ª—è—Ü–∏—è
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è **`GOOS`** –∏ **`GOARCH`**:
```bash
# Windows x64
env GOOS=windows GOARCH=amd64 go build -o src.exe .

# –°–±–æ—Ä–∫–∞ –¥–ª—è LINUX
env GOOS=linux GOARCH=amd64 go build -o src .